namespace = revolution_system

revolution_system.1 = {
	type = country_event
	hidden = yes

	trigger = {
	
		#Only fires for revolutionary countries
		is_revolutionary = yes
		
		OR = {
		
			#Voting rights
			AND = { 
				ruler = { has_ideology = ideology:ideology_autocratic }
				NOT = { has_law = law_type:law_appointed_legislature }
			}
			AND = { 
				ruler = { has_ideology = ideology:ideology_power_hungry }
				NOT = { has_law = law_type:law_appointed_legislature }
			}
			AND = { 
				ruler = { has_ideology = ideology:ideology_elitist }
				NOT = { has_law = law_type:law_technocratic_legislature }
			}
			AND = { 
				ruler = { has_ideology = ideology:ideology_democratic }
				NOT = { has_law = law_type:law_democratic_legislature }
			}
			AND = { 
				ruler = { has_ideology = ideology:ideology_liberal }
				NOT = { has_law = law_type:law_democratic_legislature }
			}
			
			#Government system
			AND = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_monarchist }
				NOT = { has_law = law_type:law_HOS_monarch }
			}
			AND = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_republican }
				NOT = { has_law = law_type:law_HOS_president }
			}
			AND = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_theocrat }
				NOT = { has_law = law_type:law_HOS_religious_leader }
			}
			AND = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_militarist }
				NOT = { has_law = law_type:law_HOS_nationalist_leader }
			}
			AND = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_communist }
				NOT = { has_law = law_type:law_HOS_communist_leader }
			}
			
		}
		
	}

	immediate = {
		
		# Add correct gov for rebels
		if = {
			limit = { 
				ruler = { has_ideology = ideology:ideology_autocratic }
				NOT = { has_law = law_type:law_appointed_legislature } 
			}
			activate_law = law_type:law_appointed_legislature
			activate_law = law_type:law_no_voting
		}
		if = {
			limit = { 
				ruler = { has_ideology = ideology:ideology_power_hungry }
				NOT = { has_law = law_type:law_appointed_legislature }
			}
			activate_law = law_type:law_appointed_legislature
			activate_law = law_type:law_no_voting
		}
		if = {
			limit = { 
				ruler = { has_ideology = ideology:ideology_elitist }
				NOT = { has_law = law_type:law_technocratic_legislature }
			}
			activate_law = law_type:law_technocratic_legislature
			activate_law = law_type:law_gerrymandered_voting
		}
		if = {
			limit = { 
				ruler = { has_ideology = ideology:ideology_democratic }
				NOT = { has_law = law_type:law_democratic_legislature }
			}
			activate_law = law_type:law_democratic_legislature
			activate_law = law_type:law_harassment_voting
		}
		if = {
			limit = { 
				ruler = { has_ideology = ideology:ideology_liberal }
				NOT = { has_law = law_type:law_democratic_legislature }
			}
			activate_law = law_type:law_democratic_legislature
			activate_law = law_type:law_fair_voting
		}
		
		if = {
			limit = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_monarchist }
				NOT = { has_law = law_type:law_HOS_monarch }
			}
			activate_law = law_type:law_HOS_monarch
		}
		if = {
			limit = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_republican }
				NOT = { has_law = law_type:law_HOS_president }
			}
			activate_law = law_type:law_HOS_president
		}
		if = {
			limit = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_theocrat }
				NOT = { has_law = law_type:law_HOS_religious_leader }
			}
			activate_law = law_type:law_HOS_religious_leader
		}
		if = {
			limit = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_militarist }
				NOT = { has_law = law_type:law_HOS_nationalist_leader }
			}
			activate_law = law_type:law_HOS_nationalist_leader
		}
		if = {
			limit = { 
				any_interest_group = { is_in_government = yes is_strongest_ig_in_government = yes has_ideology = ideology:ideology_communist }
				NOT = { has_law = law_type:law_HOS_communist_leader }
			}
			activate_law = law_type:law_HOS_communist_leader
		}
		
		# Antagonise countries & make friends
		if = {
			limit = {
				is_a_dictatorship = yes
			}
			every_country = {
				limit = { NOT = { is_a_dictatorship = yes } }
				change_relations = { country = ROOT value = -200 }
			}
			every_country = {
				limit = { is_a_dictatorship = yes }
				change_relations = { country = ROOT value = 100 }
			}
		}
		if = {
			limit = {
				is_a_nationalist_government = yes
			}
			every_country = {
				limit = { NOT = { is_a_nationalist_government = yes } }
				change_relations = { country = ROOT value = -200 }
			}
			every_country = {
				limit = { is_a_nationalist_government = yes }
				change_relations = { country = ROOT value = 100 }
			}
		}
		else_if = {
			limit = {
				is_a_communist_government = yes
			}
			every_country = {
				limit = { NOT = { is_a_communist_government = yes } }
				change_relations = { country = ROOT value = -200 }
			}
			every_country = {
				limit = { is_a_communist_government = yes }
				change_relations = { country = ROOT value = 100 }
			}
		}
		else_if = {
			limit = {
				is_a_theocratic_government = yes
			}
			every_country = {
				limit = { NOT = { is_a_theocratic_government = yes } }
				change_relations = { country = ROOT value = -200 }
			}
			every_country = {
				limit = { is_a_theocratic_government = yes }
				change_relations = { country = ROOT value = 100 }
			}
		}
		
	}

}

revolution_system.2 = {
	type = country_event
	hidden = yes
	
	immediate = {
		
		random_country = {
			limit = { 
				has_variable = demand_puppet_gov_change_overlord 
				has_subject_relation_with = ROOT
			}
			remove_variable = demand_puppet_gov_change_overlord
			save_scope_as = demand_puppet_gov_change_overlord
		}
		
		if = {
			limit = { is_sufficiently_independent = yes }
			create_diplomatic_play = {
				type = dp_independence
				target_country = scope:demand_puppet_gov_change_overlord
				add_war_goal = {
					holder = scope:demand_puppet_gov_change_overlord
					type = make_dominion
					target_country = ROOT
				}
			}
		}
		else_if = {
			limit = { NOT = { is_sufficiently_independent = yes } }
			create_diplomatic_play = {
				type = dp_independence
				target_country = scope:demand_puppet_gov_change_overlord
				add_war_goal = {
					holder = scope:demand_puppet_gov_change_overlord
					type = make_puppet
					target_country = ROOT
				}
			}
		}
		
	}
	
}