count_superstate_members = {

	#Determine members
	set_variable = { 
		name = superstate_members
		value = 0
	}
	if = {
		limit = {
			OR = {
				has_variable = superstate_free_trade_zone
				has_variable = superstate_customs_union
				has_variable = superstate_defence_union
				has_variable = superstate_political_union
			}
		}
		every_country = {
			limit = { 
				shares_same_superstate = yes
				OR = {
					has_variable = superstate_free_trade_zone
					has_variable = superstate_customs_union
					has_variable = superstate_defence_union
					has_variable = superstate_political_union
				}
			}
			ROOT = {
				change_variable = { 
					name = superstate_members
					add = 1
				}
			}
		}
	}
	else = {
		every_country = {
			limit = { 
				shares_same_superstate = yes
			}
			ROOT = {
				change_variable = { 
					name = superstate_members
					add = 1
				}
			}
		}
	}

}

create_superstate_free_trade_zone = {

	every_country = {
		limit = { 
			shares_same_superstate = yes
			has_variable = superstate_free_trade_zone
			NOR = {
				has_diplomatic_pact = { who = ROOT type = trade_agreement }
				is_junior_in_customs_union = yes
			}
		}
		create_diplomatic_pact = {
			country = ROOT
			type = trade_agreement
		}
		change_relations = { 
			country = ROOT
			value = 25
		}
	}

}

create_superstate_customs_union = {

	#Enter into Customs Union with others
	if = {
		limit = {
			has_variable = superstate_customs_union
			is_junior_in_customs_union = no
			any_country = {
				shares_same_superstate = yes
				is_junior_in_customs_union = no
				has_variable = superstate_customs_union
				this.gdp > root.gdp
			}
		}
		random_country = {
			limit = { 
				shares_same_superstate = yes
				is_junior_in_customs_union = no
				has_variable = superstate_customs_union
				this.gdp > root.gdp
			}
			create_diplomatic_pact = {
				country = ROOT
				type = customs_union
			}
			change_relations = { 
				country = ROOT
				value = 25
			}
		}
	}
	else_if = {
		limit = {
			has_variable = superstate_customs_union
			is_junior_in_customs_union = no
			any_country = {
				shares_same_superstate = yes
				is_junior_in_customs_union = no
				has_variable = superstate_customs_union
				this.gdp < root.gdp
			}
		}
		random_country = {
			limit = { 
				shares_same_superstate = yes
				is_junior_in_customs_union = no
				has_variable = superstate_customs_union
				this.gdp < root.gdp
			}
			ROOT = {
				create_diplomatic_pact = {
					country = THIS
					type = customs_union
				}
			}
			change_relations = { 
				country = ROOT
				value = 25
			}
		}
	}

}

create_superstate_currency_union = {

	#Enter into Currency Union with others
	every_country = { 
		limit = { 
			OR = { 
				NOT = { shares_same_superstate = yes }
				leads_customs_union = no
			} 
		}
		remove_diplomatic_pact = {
			country = ROOT
			type = currency_union
		}
	}
	random_country = {
		limit = { 
			shares_same_superstate = yes
			leads_customs_union = yes
			has_variable = superstate_currency_union
			NOT = { has_diplomatic_pact = { who = ROOT type = currency_union } }
		}
		create_diplomatic_pact = {
			country = ROOT
			type = currency_union
		}
		change_relations = { 
			country = ROOT
			value = 25
		}
	}

}

create_superstate_defence_union = {

	every_country = {
		limit = { 
			shares_same_superstate = yes
			has_variable = superstate_defence_union
			NOR = {
				has_diplomatic_pact = { who = ROOT type = defensive_pact }
				has_diplomatic_pact = { who = ROOT type = alliance }
			}
		}
		create_diplomatic_pact = {
			country = ROOT
			type = defensive_pact
		}
		change_relations = { 
			country = ROOT
			value = 25
		}
	}

}