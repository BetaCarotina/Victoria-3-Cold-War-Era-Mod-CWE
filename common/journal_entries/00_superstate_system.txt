je_superstate_system = {
	icon = "gfx/interface/icons/law_icons/nationalism.dds"

	scripted_button = je_join_superstate_free_trade_zone_button
	scripted_button = je_leave_superstate_free_trade_zone_button

	is_shown_when_inactive = {
	
		OR = { 
		
			#European Union
			AND = { 
				country_is_in_europe = yes
				any_primary_culture = {
					has_discrimination_trait = european_heritage
				}
			}
			
			#South American Union
			AND = { 
				country_is_in_south_america = yes
				any_primary_culture = {
					OR = { 
						has_discrimination_trait = european_heritage
						has_discrimination_trait = indigenous_american_heritage
					}
				}
			}
			
		}
		
	}

	possible = {
		
		#Tech researched
		has_technology_researched = tech_economy_4
		has_technology_researched = tech_geopolitics_4
		
		#THIS is a sovereign country
		is_sufficiently_independent = yes
		is_at_war = no
		
		#Regionalist laws
		OR = { 
			has_law = law_type:law_regionalist_fp
			has_law = law_type:law_globalist_fp
		}
		
	}

	immediate = {
		
		#Set appropriate flag
		if = {
			limit = { 
				country_is_in_europe = yes
				any_primary_culture = {
					has_discrimination_trait = european_heritage
				}
			}
			set_variable = XEU_ambitions
		}
		
		#Set appropriate flag
		if = {
			limit = { 
				country_is_in_south_america = yes
				any_primary_culture = {
					OR = { 
						has_discrimination_trait = european_heritage
						has_discrimination_trait = indigenous_american_heritage
					}
				}
			}
			set_variable = XSA_ambitions
		}
		
	}
	
	complete = {
		trigger_if = { limit = { has_variable = XEU_ambitions } c:XEU ?= this }
		trigger_if = { limit = { has_variable = XSA_ambitions } c:XSA ?= this }
	}
	
	on_complete = {
		
		#Prestige from unification
		add_modifier = { 
			name = national_pride_modifier 
			years = 60 
			is_decaying = yes 
		}
		
	}
	
	fail = {
	
		NAND = { 
			is_sufficiently_independent = yes
			
			OR = { 
				has_law = law_type:law_regionalist_fp
				has_law = law_type:law_globalist_fp
			}
		}
	
	}
	
	on_fail = {
		
		#Clear superstate ambition and pacts
		remove_variable = XEU_ambitions
		remove_variable = XSA_ambitions
		
		remove_variable = superstate_free_trade_zone
		remove_variable = superstate_customs_union
		remove_variable = superstate_defence_union
		remove_variable = superstate_political_union
		
	}

	on_yearly_pulse = {
		
		effect = {
			
			if = {
				limit = { 
					has_variable = superstate_free_trade_zone 
				}
				every_country = {
					limit = { 
						OR = { 
							AND = { has_variable = XEU_ambitions ROOT = { has_variable = XEU_ambitions } }
							AND = { has_variable = XSA_ambitions ROOT = { has_variable = XSA_ambitions } }
						}
						NOR = {
							has_diplomatic_pact = { who = ROOT type = trade_agreement }
							is_junior_in_customs_union = yes
						}
					}
					create_diplomatic_pact = {
						country = ROOT
						type = trade_agreement
					}
				}
			}
			
			if = {
				limit = { 
					has_variable = superstate_defence_union 
				}
				every_country = {
					limit = { 
						OR = { 
							AND = { has_variable = XEU_ambitions ROOT = { has_variable = XEU_ambitions } }
							AND = { has_variable = XSA_ambitions ROOT = { has_variable = XSA_ambitions } }
						}
						NOR = {
							has_diplomatic_pact = { who = ROOT type = defensive_pact }
							has_diplomatic_pact = { who = ROOT type = alliance }
						}
					}
					create_diplomatic_pact = {
						country = ROOT
						type = defensive_pact
					}
				}
			}
			
		}
		
	}

	weight = 0

	should_be_pinned_by_default = yes

	transferable = no

	progressbar = no
}